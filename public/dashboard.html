<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Automation Dashboard</title>
<style>
body{margin:0;font-family:Arial;background:#0b0f1a;color:#fff}
.container{display:flex;min-height:100vh}
.sidebar{width:320px;background:#0f172a;padding:18px}
.main{flex:1;padding:18px}
input,textarea,select{
width:100%;padding:10px;margin-top:6px;
background:#020617;border:1px solid #1e293b;
color:#fff;border-radius:6px}
button{width:100%;padding:10px;margin-top:10px;border:0;border-radius:6px;font-weight:bold}
.start{background:#22c55e}
.stop{background:#ef4444}
.cards{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:10px}
.card{background:#020617;padding:10px;text-align:center;border-radius:8px}
</style>
</head>
<body>

<div class="container">

<div class="sidebar">
<h2>ENGINE CONTROL</h2>

<textarea id="numInput" rows="4" placeholder="01711111111"></textarea>
<button onclick="addNumber()">ADD NUMBERS</button>
<div>Total: <span id="numCount">0</span></div>

<input id="delayInput" type="number" value="2000" placeholder="Delay ms">
<input id="threadInput" type="number" value="1" placeholder="Threads">

<select id="headlessInput">
<option value="true">Hidden (Headless)</option>
<option value="false">Show Browser</option>
</select>

<button class="start" onclick="startEngine()">START</button>
<button class="stop" onclick="stopEngine()">STOP</button>

<div id="status">Idle</div>
</div>

<div class="main">
<div class="cards">
<div class="card">SUCCESS <p id="success">0</p></div>
<div class="card">FAILED <p id="failed">0</p></div>
<div class="card">ERROR <p id="error">0</p></div>
<div class="card">TOTAL <p id="total">0</p></div>
</div>
</div>

</div>

<script>
let numbers=[];

function addNumber(){
const raw=document.getElementById("numInput").value.trim();
if(!raw) return;
raw.split(/[\n, ]+/).forEach(n=>{
if(n && !numbers.includes(n)) numbers.push(n);
});
document.getElementById("numInput").value="";
document.getElementById("numCount").innerText=numbers.length;
}

async function startEngine(){
await fetch("/api/start-job",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body:JSON.stringify({
numbers,
delay:parseInt(delayInput.value)||2000,
threads:parseInt(threadInput.value)||1,
headless: headlessInput.value==="true"
})
});
status.innerText="Running";
}

async function stopEngine(){
await fetch("/api/stop-job",{method:"POST"});
status.innerText="Stopped";
}

async function updateStatus(){
const r=await fetch("/api/status");
const d=await r.json();
success.innerText=d.success;
failed.innerText=d.failed;
error.innerText=d.error;
total.innerText=d.total;
if(!d.running) status.innerText="Idle";
}

setInterval(updateStatus,1000);
</script>

</body>
</html>
